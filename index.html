<!DOCTYPE html>
<html>

<head>
    <script src="/socket.io/socket.io.js"></script>

    <title> VoxelVale </title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <style>
    .container{
        position:relative;
        font-size:65px;
        outline: none;
    }
    .container:focus{
        outline: none;
    }
    #gl-canvas{
        z-index:0;
        font-family: 'MDIO';
    }
    #text-canvas{
        pointer-events: none;
        position:absolute;
        left:0px;
        top:0px;
        z-index:1;
        font-family: 'MDIO';
    }
    </style>

    <link rel="stylesheet" type="text/css" href="res/style.css">

</head>

<script id="vertex-shader" type="x-shader/x-vertex">
precision mediump float;
attribute vec4 vPosition;
attribute vec3 vNormal;
attribute vec4 vColor;
uniform mat4 projectionMatrix;
uniform mat4 modelViewMatrix;
uniform mat4 shadowMatrix;
varying vec4 fColor;

varying float magnitude;

//Texturing...
attribute vec2 vTexCoord;
varying vec2 fTexCoord;

//Lighting...
uniform vec4 ambientProduct, diffuseProduct, specularProduct;
uniform vec4 lightPosition;
uniform float shininess;


void main()
{
    vec4 pos = modelViewMatrix * vPosition;
    vec3 position = -(pos).xyz;
    vec3 light = -lightPosition.xyz;
    vec3 L = normalize(light-position);

    //Distance fall off.
    float dist = length(light-position);
    float attenuation = 1.0/(0.5 + 0.25*dist + 0.1*dist*dist);

    vec3 E = normalize(-position);
    vec3 H = normalize(L+E);

    vec4 NN = vec4(vNormal,0);
    vec3 N = normalize((modelViewMatrix*NN).xyz);

    vec4 ambient = ambientProduct;

    float KD = max(dot(L,N),0.0);
    vec4 diffuse = KD*diffuseProduct*attenuation;

    float KS = pow(max(dot(N,H),0.0),shininess);
    vec4 specular = KS*specularProduct;

    if(dot(L,N)<0.0) specular = vec4(0.0,0.0,0.0,1.0);

    fColor = (ambient+diffuse+specular) * vColor;
    //fColor = vColor;
    //fColor = (diffuse + ambient)*vColor;

    fTexCoord = vTexCoord;

    gl_PointSize = 5.0;

    gl_Position = projectionMatrix*modelViewMatrix*vPosition;


    magnitude = length((gl_Position).xy);
}
</script>

<script id="fragment-shader" type="x-shader/x-fragment">
precision mediump float;

varying vec4 fColor;

varying float magnitude;

varying vec2 fTexCoord;
uniform sampler2D texture;

uniform bool disableTex;

uniform vec4 sColor;

//Cursor
uniform bool cursorBlock;
uniform bool flashing;

//Particle
uniform bool isParticle;
uniform vec4 particleColor;

//Ceilings
uniform bool isCeiling;
uniform float opacityFactor;
uniform bool inDungeon;

void main()
{


    gl_FragColor = texture2D(texture, fTexCoord )*fColor;
    //gl_FragColor = fColor;

    if(fTexCoord[0] > 1.0 || fTexCoord[1] > 1.0)
        gl_FragColor = fColor;

    if(sColor[0] == 0.0){
        vec2 uv = gl_FragCoord.xy / vec2(1280, 720);
        vec2 centered = uv - vec2(0.5);
        float dist = length(centered);
        float fade = smoothstep(0.5, 0.0, dist);
        gl_FragColor = vec4(sColor.rgb, sColor.a*fade);
        return;
    }

    if(cursorBlock == true){
        gl_FragColor = texture2D(texture, fTexCoord )*fColor*vec4(1.0, 1.0, 1.0, 0.3);
        return;
    }

    if(flashing == true){
        gl_FragColor = vec4(0.95,0.1,0.1,1.0);
        return;
    }

    if(isParticle == true){
        gl_FragColor = particleColor;
        return;
    }

    if(isCeiling == true && inDungeon != true ){
        vec2 uv = gl_FragCoord.xy / vec2(1280, 720);
        vec2 centered = uv - vec2(0.5,0.6);
        float dist = length(centered);
        float fade = smoothstep(0.4, 0.0, dist);
        float sub = fade-opacityFactor;
        gl_FragColor = vec4((texture2D(texture, fTexCoord )*fColor).xyz,(1.0-sub));
        return;
    }

    if(isCeiling == true && inDungeon == true ){
        vec2 uv = gl_FragCoord.xy / vec2(1280, 720);
        vec2 centered = uv - vec2(0.5,0.5);
        float dist = length(centered);
        float fade = smoothstep(0.75, 0.1, dist);
        float sub = fade-opacityFactor;
        gl_FragColor = vec4((texture2D(texture, fTexCoord )*fColor).xyz,(1.0-sub));
        return;
    }
}
</script>

<script type="text/javascript" src="voxelvale/Common/webgl-utils.js"></script>
<script type="text/javascript" src="voxelvale/Common/initShaders.js"></script>
<script type="text/javascript" src="voxelvale/Common/MV.js"></script>

<script type="text/javascript" src="voxelvale/code/flags.js"></script>
<script type="text/javascript" src="voxelvale/code/worldgen.js"></script>
<script type="text/javascript" src="voxelvale/code/datastructures.js"></script>
<script type="text/javascript" src="voxelvale/code/controls.js"></script>
<script type="text/javascript" src="voxelvale/code/modelingtools.js"></script>
<script type="text/javascript" src="voxelvale/code/main.js"></script>
<script type="text/javascript" src="voxelvale/code/player.js"></script>
<script type="text/javascript" src="voxelvale/code/tile.js"></script>
<script type="text/javascript" src="voxelvale/code/blockwall.js"></script>
<script type="text/javascript" src="voxelvale/code/xyzblock.js"></script>
<script type="text/javascript" src="voxelvale/code/dropbox.js"></script>
<script type="text/javascript" src="voxelvale/code/scenes.js"></script>
<script type="text/javascript" src="voxelvale/code/dungeons.js"></script>
<script type="text/javascript" src="voxelvale/code/collision.js"></script>
<script type="text/javascript" src="voxelvale/code/collisions.js"></script>
<script type="text/javascript" src="voxelvale/code/enemy.js"></script>
<script type="text/javascript" src="voxelvale/code/enemyroller.js"></script>
<script type="text/javascript" src="voxelvale/code/notifications.js"></script>
<script type="text/javascript" src="voxelvale/code/popup.js"></script>
<script type="text/javascript" src="voxelvale/code/UI.js"></script>
<script type="text/javascript" src="voxelvale/code/healthbar.js"></script>
<script type="text/javascript" src="voxelvale/code/uifunctions.js"></script>
<script type="text/javascript" src="voxelvale/code/inventory.js"></script>
<script type="text/javascript" src="voxelvale/code/craftingmenu.js"></script>
<script type="text/javascript" src="voxelvale/code/item.js"></script>
<script type="text/javascript" src="voxelvale/code/nonactionableitem.js"></script>
<script type="text/javascript" src="voxelvale/code/recipes.js"></script>
<script type="text/javascript" src="voxelvale/code/projectiles.js"></script>
<script type="text/javascript" src="voxelvale/code/structures.js"></script>
<script type="text/javascript" src="voxelvale/code/buildingfunctions.js"></script>
<script type="text/javascript" src="voxelvale/code/specialblocks.js"></script>
<script type="text/javascript" src="voxelvale/code/interactiveblocks.js"></script>
<script type="text/javascript" src="voxelvale/code/cursorfunctions.js"></script>
<script type="text/javascript" src="voxelvale/code/particles.js"></script>
<script type="text/javascript" src="voxelvale/code/music.js"></script>
<script type="text/javascript" src="voxelvale/code/sounds.js"></script>
<script type="text/javascript" src="voxelvale/code/saveload.js"></script>

<!--
<script type="text/javascript" src="voxelvale/voxelvale.min.js"></script>
-->

<script type="module" src="voxelvale/firebase.js"></script>




<body style="background-color: rgb(var(--color-bg));" id="body">
    <header>
       <div style="float:left; padding-left:25px; margin:0px;"class="vertical-center"> <img border="0" style="image-rendering: pixelated;" width="148%" src="res/logo.png"></div>
       
        <nav  class="vertical-center" style="text-align: center;right:0px; width:100%;">
            <a class = "navbox" href="#about">About</a>
            <a class = "navbox" href="#attributions">Atributions</a>
            <a class = "navbox" target="_blank" rel="noopener noreferrer" href="https://patreon.com/VoxelVale">Patreon</a>
        </nav>
        <nav class="vertical-center" style="padding-right:0px; padding-left: 0px;right: 0px; visibility: hidden" id = "loggedout">
          <ul style="padding-right:0px; padding-left:0px;">
            <li  style="padding-right:10px; padding-right:10px;margin: 0px; margin-top:4px;"> <input type="email" id="email" placeholder="Email"></input></li>
            <li  style="padding-right:10px; padding-right:10px;margin: 0px; margin-right: 10px; margin-top:4px;"> <input type="password" id="password" placeholder="Password"></input></li>
            <li  style="padding:5px;padding-right:10px;margin: 0px;"> <button onclick="logIn()">Log In</button></li>
            <li  style="padding:5px;padding-right:10px;margin: 0px;"> <button onclick="signUp();">Sign Up</button></li>
          </ul>
        </nav>
        <nav class="vertical-center" style="padding-right:0px; padding-left: 0px;right: 0px; visibility:hidden;" id = "loggedin">
          <ul style="padding-right:0px; padding-left:0px;">
            <li  style="padding:5px;padding-right:10px;margin: 0px; margin-right: 10px;margin-top:1px;" id="useremail"> </li>
            <li  style="padding:5px;padding-right:10px;margin: 0px;margin-right:10px;"><button onclick="logOut()">Log Out</button></li>
          </ul>
        </nav>
  </header>
    <!-- GAME CONTAINER -->
    <div class="gameBackground" style="padding-top:97px;">
        <div style="padding: 1rem 1rem;   max-width: 1280px;  margin: auto; ">
            <div class="gameBorder colorStyle" style="height: 720px; padding:0px;">   
                <div class=container>
                    <canvas id="gl-canvas" width="1280" height="720" stencil="true">
                    <!-- The following message is displayed if the browser doesn’t -- support HTML5 -->
                    Sorry; your web browser does not support HTML5’s canvas element.
                    </canvas>
                    <canvas id="text-canvas" width="1280" height="720"></canvas>
                </div>
            </div>
        </div>
        <div style="text-align: center; font-size: 11px; color:#000">Version: Alpha 0.0.1 | <a target="_blank" rel="noopener noreferrer" class="bug" href="https://docs.google.com/forms/d/e/1FAIpQLSeGaSDpu5x3GT1NgmaPX4DZB6JiqrphzgQs86RfYrY6pL8NeQ/viewform?usp=dialog">Report a bug.</a></div>
    </div>
    <div style="margin: auto;scroll-margin-top: 80px;" id="about">
        <div class="boxBorder colorStyle">   
            <h1>About</h1>
            <hr class="section-underline">
            <div class = "textBox">
                VoxelVale is a browser-based game developed independently by me, Jay. It's inspired by the openess of early Zelda games, the creative freedom of Minecraft, and the random nature of roguelike games like The Binding of Isaac. It's built entirely in JavaScript and WebGL.<br><br>

                Initially, VoxelVale was just a pet project I worked on sporadically over a few months in 2021 (after taking a graphics course). I had built an interesting foundation for a game, but hadn't fleshed out much of the gameplay. I began reviving it in April 2025 out of boredom, and started to see the potential for more interesting gameplay. 

                I made the decision to share it for free in case anyone else thought it looked interesting. This is a self-funded endevor that I sink a little too much time into, so if you enjoy the gameplay so far, please consider becoming a Patron! I plan to add some interesting perks for members.<br><br>

                As a last remark, the game is still very early in development. There will be a lot of features that don't behave as expected, and a lot of bugs. If you see any you can report them using the link below the game. Updates on the development will all be visible on Patreon. If you have ideas or things you would like to see in the game, you can connect with me over Patreon. <br><br>

                That's all thanks for reading!
            </div>
        </div>
    </div>

    <div style="margin: auto; scroll-margin-top: 80px;" id="attributions">
        <div class="boxBorder colorStyle">   
            <h1>Attributions</h1>
            <hr class="section-underline">
            <div class = "textBox">

                <h2> Music (Overworld)</h2>
                <ul>
                    <li><a class="linkstyle" href="https://opengameart.org/content/snowfall"> Snowfall | Kistol </a></li>
                    <li><a class="linkstyle" href="https://opengameart.org/content/old-city-theme"> Old City Theme | remaxim </a></li>
                    <li><a class="linkstyle" href="https://opengameart.org/content/chill-lofi-inspired  "> Chill lofi  | omfgdude </a></li>
                    <li><a class="linkstyle" href="https://opengameart.org/content/vampires-piano"> Vampire's Piano | TAD </a></li>
                    <li><a class="linkstyle" href="https://opengameart.org/content/nature-theme-sketch"> Nature Theme | remaxim </a></li>
                    <li><a class="linkstyle" href="https://opengameart.org/content/town-theme"> Town Theme | remaxim </a></li>
                    <li><a class="linkstyle" href="https://opengameart.org/content/snow-city-theme"> Snow City | Tarush Singhal </a></li>
                    <li><a class="linkstyle" href="https://opengameart.org/content/emotional-mood-piece"> Emotional Mood Piece | remaxim </a></li>
                    <li><a class="linkstyle" href="https://opengameart.org/content/safe-room-theme"> Safe Room Theme | remaxim </a></li>
                    <li><a class="linkstyle" href="https://opengameart.org/content/hungry-tribes"> Hungry Tribes | remaxim </a></li>
                    <li><a class="linkstyle" href="https://opengameart.org/content/dreamlike-state"> Dreamlike State | Tarush Singhal </a></li>
                    <li><a class="linkstyle" href="https://opengameart.org/content/8-bit-prairie"> 8 Bit Prairie | Tarush Singhal </a></li>
                    <li><a class="linkstyle" href="https://opengameart.org/content/8-bit-summer-memory"> 8 bit summer memory | Tarush Singhal </a></li>
                    <li><a class="linkstyle" href="https://opengameart.org/content/small-town"> Small Town | Tarush Singhal </a></li>
                    <li><a class="linkstyle" href="https://opengameart.org/content/forest-7"> Forest | Tarush Singhal </a></li>
                </ul>
                <h2> Music (Caves/Dungeons)</h2>
                <ul>
                    <li><a class="linkstyle" href="https://opengameart.org/content/franz-liszt-19-hungarian-rhapsodies"> Franz Liszt - 19 Hungarian Rhapsodies | remaxim </a></li>
                    <li><a class="linkstyle" href="https://opengameart.org/content/infiltrator"> Infiltrator | remaxim </a></li>
                    <li><a class="linkstyle" href="https://opengameart.org/content/feeding-frenzy"> Feeding Frenzy | remaxim </a></li>
                    <li><a class="linkstyle" href="https://opengameart.org/content/dungeon-theme"> Dungeon Theme | remaxim </a></li>
                    <li><a class="linkstyle" href="https://opengameart.org/content/palm-of-my-hand-at-the-altar"> Palm of my hand - At the altar | Harold Azmed </a></li>
                    <li><a class="linkstyle" href="https://opengameart.org/content/palm-of-my-hand-intro"> Palm of my hand - Intro | Harold Azmed </a></li>
                    <li><a class="linkstyle" href="https://opengameart.org/content/deep-space-flight"> Deep Space Flight | remaxim </a></li>
                    <li><a class="linkstyle" href="https://opengameart.org/content/dungeon-king"> Dungeon King | professorlamp </a></li>
                    <li><a class="linkstyle" href="https://opengameart.org/content/dungeon-dwellers-dungeon-track-for-rpg"> Dungeon Dwellers | BitsAndPiecesMusic </a></li>
                    <li><a class="linkstyle" href="https://opengameart.org/content/cold-sanctuary-rpg-orchestral-essentials-dungeon-music"> Cold Sanctuary </a></li>
                    <li><a class="linkstyle" href="https://opengameart.org/content/rpg-ambience-dungeon"> RPG Ambience - Dungeon | Hitctrl </a></li>
                    <li><a class="linkstyle" href="https://opengameart.org/content/wander-in-a-dungeon"> Wander in a dungeon | Kosmo The Cat </a></li>
                    <li><a class="linkstyle" href="https://opengameart.org/content/dungeon-chip"> Dungeon chip | divjedrevo </a></li>
                    <li><a class="linkstyle" href="https://opengameart.org/content/zelda-like-dungeon-theme"> Zelda-like Dungeon theme | genderfreak </a></li>
                    <li><a class="linkstyle" href="https://opengameart.org/content/small-dungeon"> SMALL dungeon | genderfreak </a></li>
                    <li><a class="linkstyle" href="https://opengameart.org/content/dungeon-deep-0"> Dungeon Deep | Eldritch Grim </a></li>
                </ul>
                <h2> Sound Effects </h2>
                <ul>
                    <li><a class="linkstyle" href="https://opengameart.org/content/foot-walking-step-sounds-on-stone-water-snow-wood-and-dirt"> Foot walking step sounds | Jute </a></li>
                    <li><a class="linkstyle" href="https://opengameart.org/content/door-open-door-close-set"> Door Open, Door Close Set | qubodup </a></li>
                    <li><a class="linkstyle" href="https://opengameart.org/content/impact"> Impact | qubodup </a></li>
                    <li><a class="linkstyle" href="https://opengameart.org/content/bubbles-pop"> bubbles 'pop' | farfadet46 </a></li>
                    <li><a class="linkstyle" href="https://opengameart.org/content/monster-sound-effects-pack"> Monster Sound Effects Pack | Ogrebane </a></li>
                    <li><a class="linkstyle" href="https://opengameart.org/content/door-open-door-close"> Door open, door close | Iwan Gabovitch </a></li>
                    <li><a class="linkstyle" href="https://opengameart.org/content/monster-sound-pack-volume-1"> Monster Sound Pack, Volume 1 | Ogrebane </a></li>
                    <li><a class="linkstyle" href="https://opengameart.org/content/footsteps-leather-cloth-armor"> Footsteps Leather, Cloth, Armor | HaelDB </a></li>
                    <li><a class="linkstyle" href="https://opengameart.org/content/swishes-sound-pack"> Swishes Sound Pack | artisticdude </a></li>
                    <li><a class="linkstyle" href="https://opengameart.org/content/bow-arrow-shot"> Bow & Arrow Shot </a></li>
                    <li><a class="linkstyle" href="https://opengameart.org/content/medieval-sound-effects-weapon-textures"> Medieval sound effects | Ben Jaszczak & Brian Nelson </a></li>
                    <li><a class="linkstyle" href="https://opengameart.org/content/thwack-sounds"> Thwack Sounds | AntumDeluge </a></li>
                    <li><a class="linkstyle" href="https://opengameart.org/content/stop"> Stop | Blender Foundation </a></li>
                    <li><a class="linkstyle" href="https://opengameart.org/content/vibrating-plastic"> Vibrating Plastic | remaxim </a></li>
                </ul>
            </div>
        </div>
    </div>

    <!--
    <br><br><br><br><br><br>

    <button onclick="saveWorld()">Save World</button>-->
    <!--
    <button onclick="getWorldObj()">Save World</button>
    
    <button onclick="saveWorld()">Save World To Firebase</button>

    <button onclick="loadWorld()">Load World From Firebase</button>


        <b> Sign up / Login </b>
   
    
    <button onclick="signUp();">Sign Up</button>
    <button onclick="logIn()">Log In</button>
    <button onclick="logOut()">Log Out</button>


    

    <br><br><br>

       <br><br><br>
    <span id = "username"></span><br>
 <b>Attributions:</b> I'm stuff<br><br>
-->
</body>

<script type="text/javascript">
    var socket = io();
    var initialized = false;
</script>

<script type="text/javascript" src="net.js"></script>

<img id="scream" src="voxelvale/textures/textures.png" width="256" height="256" hidden></img>
<canvas id="myCanvas" width="256" height="256" hidden></canvas>

</html>